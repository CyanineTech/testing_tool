# Testing Tool Web Service

这是一个基于Web的管理界面，用于管理和执行testing_tool中的Python脚本。

## 功能特性

- 📜 **脚本管理**: 自动扫描并显示所有Python脚本，支持编辑脚本描述和工作流程说明
- ⚙️ **配置管理**: 在Web界面中查看和编辑config.ini配置文件
- ▶️ **脚本执行**: 在Web界面中选择脚本并执行，支持自定义命令行参数
- 🖥️ **实时输出**: 执行脚本时实时显示终端输出
- ⏹️ **中断执行**: 支持随时中断正在运行的脚本
- 📋 **日志查看**: 查看和管理日志文件
- ⬇️ **脚本下载**: 下载单个脚本文件

## 安装依赖

```bash
pip install -r requirements.txt
```

## 启动服务

```bash
python web_service.py
```

或者直接运行:

```bash
python3 web_service.py
```

服务启动后，访问: http://localhost:5000

## 使用说明

### 1. 脚本管理页面

在这里可以查看所有Python脚本，点击"编辑"按钮可以修改：
- 脚本描述：对脚本功能的简要说明
- 工作流程：详细的使用步骤和注意事项

点击"下载"按钮可以下载单个脚本文件。

### 2. 配置管理页面

显示config.ini文件的所有配置项，可以直接在页面中编辑并保存。
配置按section分组显示，修改后点击"保存配置"按钮。

### 3. 执行脚本页面

1. 从下拉菜单选择要执行的脚本
2. (可选) 输入命令行参数，例如: `--debug --scene_id 18`
3. 查看工作流程说明
4. 点击"执行脚本"按钮开始运行
5. 实时查看终端输出
6. 如需中断，点击"停止执行"按钮

### 4. 日志查看页面

- 左侧显示所有日志文件列表
- 点击日志文件名可以查看内容（显示最后1000行）
- 点击"刷新"按钮可以重新加载当前日志

## 技术架构

- **后端**: Flask (Python web框架)
- **前端**: HTML + CSS + JavaScript (原生实现，无需额外框架)
- **实时通信**: Server-Sent Events (SSE) 用于实时传输脚本输出
- **进程管理**: Python subprocess模块管理脚本进程

## 注意事项

1. **端口占用**: 默认使用5000端口，如需修改请编辑web_service.py文件最后一行
2. **权限要求**: 需要对testing_tool目录有读写权限
3. **多进程**: 支持同时运行多个脚本，每个脚本独立管理
4. **安全性**: 本服务设计用于内网环境，如需公网访问请添加认证机制

## 停止服务

在终端中按 `Ctrl+C` 可以安全停止服务，所有运行中的进程会被自动清理。

## 故障排除

### 服务无法启动

1. 检查是否安装了所有依赖: `pip install -r requirements.txt`
2. 检查5000端口是否被占用
3. 检查Python版本 (需要Python 3.7+)

### 无法执行脚本

1. 确保脚本文件有执行权限
2. 检查config.ini配置是否正确
3. 查看终端输出的错误信息

### 日志无法显示

1. 检查日志文件是否存在
2. 确保日志文件编码为UTF-8
3. 检查文件读取权限

## 开发信息

项目结构:
```
testing_tool/
├── web_service.py          # Flask应用主文件
├── templates/
│   └── index.html         # Web界面HTML模板
├── static/                # 静态资源目录
├── script_descriptions.json # 脚本描述数据
├── config.ini             # 配置文件
├── requirements.txt       # Python依赖
└── WEB_SERVICE_README.md  # 本文档
```

## 贡献

欢迎提交问题和改进建议！
